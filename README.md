# 🎨 Auto Get Layer

一个智能的 Figma 插件，专注于节点分析、自动布局优化和响应式设计最佳实践。

## ✨ 主要功能

### 📊 节点分析
- **智能信息提取**: 提取选中节点的详细信息，包括属性、尺寸、位置等
- **格式化输出**: 支持复制格式化的文本报告和JSON数据
- **UI规范检查**: 自动检测设计规范违规项，提供修复建议
- **详细报告**: 生成包含统计信息和分析结果的完整报告

### 🎯 布局优化
- **智能侧边栏布局**: 自动分析现有布局，应用最佳的自动布局配置
- **响应式尺寸设置**: 根据布局方向自动设置子元素的最佳尺寸模式
- **自动布局修复**: 检测并修复布局问题，启用自动布局功能
- **样式保持**: 在启用自动布局时保持原有的视觉效果

### 🔧 开发工具
- **测试节点创建**: 创建各种测试节点用于功能验证
  - 📦 Groups: 创建基础Group测试节点
  - 🖼️ Frames: 创建Frame测试结构
  - 🏗️ 复杂结构: 创建嵌套的复杂节点结构
  - 🃏 卡片列表: 创建包含多种信息的复杂卡片布局
- **图片下载**: 支持PNG和SVG格式的图片导出
- **权限检查**: 智能检测编辑权限，只读模式下提供调试功能
- **一键清理**: 快速清理所有测试节点

## 🚀 快速开始

### 安装
1. 下载插件文件
2. 在 Figma 中打开插件开发模式
3. 导入 `manifest.json` 文件

### 使用方法

#### 节点分析
1. 选择要分析的节点
2. 点击 "📄 提取节点信息"
3. 使用 "📋 复制格式化输出" 获取可读报告
4. 使用 "📦 复制JSON数据" 获取结构化数据

#### 智能布局
1. 选择包含子元素的 Frame
2. 点击 "🎯 应用侧边栏布局" 或 "🔧 修复Frame选择"
3. 系统会自动：
   - 分析现有布局
   - 计算最优间距和填充
   - 设置响应式尺寸
   - 应用最佳实践

#### 测试节点创建
1. 使用测试节点区域的按钮创建不同类型的测试结构：
   - **📦 Groups**: 创建基础的Group组合
   - **🖼️ Frames**: 创建Frame测试结构
   - **🏗️ 复杂结构**: 创建嵌套的复杂节点结构
   - **🃏 卡片列表**: 创建包含图片、文字、评分、价格等多种信息的产品卡片列表
2. 使用 "🔧 自动修复全部" 测试布局优化效果
3. 使用 "🗑️ 清理测试节点" 清理所有测试内容

#### 调试模式（只读权限）
当文件为只读模式时，插件会提供：
- 📋 复制节点路径
- 💬 复制调试提示词（可发送给AI助手分析）

## 🎯 响应式尺寸最佳实践

插件会根据布局方向自动设置子元素的尺寸：

- **垂直布局**: 子元素宽度设置为 `FILL`（填充父容器），高度设置为 `HUG`（自适应内容）
- **水平布局**: 子元素高度设置为 `FILL`（填充父容器），宽度设置为 `HUG`（自适应内容）

这确保了子元素能够响应父容器的尺寸变化，符合现代UI设计规范。

## 📋 详细日志

插件提供详细的操作日志：
- 打开浏览器开发者控制台 (Cmd+Option+I / Ctrl+Shift+I)
- 查看每个操作的详细过程
- 包含原始状态、修改内容和最终结果

## 🛠️ 开发

### 环境要求
- Node.js 14+
- TypeScript 4+

### 构建
```bash
npm install
npm run build
```

### 开发模式
```bash
npm run dev
```

## 📁 项目结构

```
auto-get-layer/
├── code.ts                 # 主要插件逻辑
├── ui.html                 # 用户界面
├── manifest.json           # 插件配置
├── SIDEBAR_LAYOUT_FEATURE.md  # 功能文档
├── README.md               # 项目说明
├── package.json            # 依赖配置
├── tsconfig.json           # TypeScript配置
├── test/                   # 测试文件
└── utils/                  # 工具函数
```

## 🎨 UI设计

插件采用现代化的设计语言：
- 渐变色头部
- 卡片式布局
- 响应式设计
- 平滑动画效果
- 智能状态反馈

## 🔍 主要特性

### 智能分析
- 自动检测布局方向
- 计算最优间距和填充
- 分析子元素排列模式
- 生成详细的诊断报告

### 最佳实践
- 遵循 CSS Flexbox 规范
- 应用响应式设计原则
- 保持样式一致性
- 支持事务性操作和回滚

### 用户体验
- 直观的操作界面
- 详细的操作反馈
- 智能错误处理
- 权限感知功能

## 📝 更新日志

### v1.2.1 (2024-12-19)
- 🎯 **Frame Selection集成**: 
  - 使用Figma内置Frame Selection功能替代手动坐标计算
  - 自动处理分组的边界框和位置关系
  - 消除NaN坐标错误，提供更稳定的分组体验
- 🧪 **增强测试**: 新增 [frame-selection-test.js](test/frame-selection-test.js) 验证Frame Selection功能
- 🔧 **代码优化**: 简化分组创建逻辑，提高代码可维护性
- 🚀 **性能提升**: Frame Selection减少了复杂的坐标计算，提升分组速度

### v1.2.0 (2024-12-19)
- 🎯 **双算法智能分组**: 
  - **BFS几何分组**(推荐): 基于广度优先搜索和矩形包围盒的自适应分组
  - **规则匹配分组**: 基于预定义规则的传统分组方式
- 📊 **算法性能对比**: 
  - BFS算法: O(n×log n)复杂度，85-95%准确率，适合复杂布局
  - 规则算法: O(n×k)复杂度，75-85%准确率，适合标准布局
- 🧠 **智能空间分析**: 矩形包围盒计算、距离测量、邻域发现
- 🔍 **多维度语义评分**: 名称、类型、尺寸、对齐四维度综合评分
- 🔧 **动态聚类优化**: 自动合并单元素聚类，分割过大聚类
- 📝 **自动语义命名**: 基于元素功能类型的智能命名
- 📋 **详细算法对比**: 新增 [BFS_ALGORITHM_COMPARISON.md](BFS_ALGORITHM_COMPARISON.md) 完整技术分析
- 🎨 **UI升级**: 支持算法选择，实时显示分组效果

### v1.1.0 (2024-12-19)
- 🃏 **新增卡片列表创建功能**: 创建包含多种信息的复杂产品卡片布局
- 📱 **增强测试工具**: 新增4种不同类型的测试节点创建选项
- 🎨 **改进UI设计**: 重新组织测试工具区域，增加Toast通知系统
- 🧪 **完整测试套件**: 添加专门的测试文件和详细文档
- 🗑️ **一键清理功能**: 支持快速清理所有测试节点
- 📋 **详细文档**: 新增 [CARD_LIST_FEATURE.md](CARD_LIST_FEATURE.md) 功能说明文档

### v1.0.0
- 全新的现代化UI设计
- 智能响应式尺寸设置
- 格式化输出复制功能
- 权限检查和只读模式支持
- 详细的操作日志
- 优化的代码结构

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

---

🎨 **Auto Get Layer** - 让 Figma 设计更智能、更高效！
